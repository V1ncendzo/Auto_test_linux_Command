[{
  "title": "Linux Base64 Encoded Pipe to Shell (Hardened)",
  "id": "ba592c6d-6888-43c3-b8c6-689b8fe47337",
  "description": "Detects suspicious process command line that uses base64 encoded input for execution with a shell, robust against common obfuscation techniques.",
  "sigmafile": "",
  "sigma": [
    "SELECT * FROM logs WHERE CommandLine REGEXP 'b[\\\"\\\\]*a[\\\"\\\\]*s[\\\"\\\\]*e[\\\"\\\\]*6[\\\"\\\\]*4' AND CommandLine REGEXP '\\|\\s*(/bin/|/usr/bin/)?[\\\"\\\\]*(sh|bash|zsh|dash|ksh)[\\\"\\\\]*'"
  ],
  "rule_level": "high",
  "tags": [
    "attack.defense-evasion",
    "attack.t1140",
    "attack.execution"
  ],
  "count": 2,
  "matches": [
    {
      "row_id": 9,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 1,
      "Version": 5,
      "Level": 4,
      "Task": 1,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-09T06:01:33.870212000Z",
      "EventRecordID": 87354,
      "ProcessID": "8040",
      "ThreadID": "8040",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-09 05:33:18.485",
      "ProcessGuid": "{8b8a9dc4-931e-6960-1d98-7ee1a9570000}",
      "Image": "/usr/bin/dash",
      "User": "root",
      "OriginalLogfile": "Linux_Base64_Encoded_Pipe_to_Shell_attack15.log-QJ5TVKCT.json",
      "FileVersion": "-",
      "Description": "-",
      "Product": "-",
      "Company": "-",
      "OriginalFileName": "-",
      "CommandLine": "/bin/sh -c /bin/bash -c 'echo \"ZWNobyAiVHJpZ2dlcmluZyBTaWdtYSBSdWxlIiA7IGlkCg==\" | base64 -d |/bin/sh;:'",
      "CurrentDirectory": "/home/vincenzolog/Auto_test",
      "LogonGuid": "{8b8a9dc4-0000-0000-0000-000006000000}",
      "LogonId": 0,
      "TerminalSessionId": 3,
      "IntegrityLevel": "no level",
      "SHA256": "86d31f6fb799e91fa21bad341484564510ca287703a16e9e46c53338776f4f42",
      "Hashes": "SHA256=86d31f6fb799e91fa21bad341484564510ca287703a16e9e46c53338776f4f42",
      "ParentProcessGuid": "{8b8a9dc4-92db-6960-1d23-700000000000}",
      "ParentProcessId": 9669,
      "ParentImage": "/usr/bin/python3.12",
      "ParentCommandLine": "python3",
      "ParentUser": "root"
    },
    {
      "row_id": 10,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 1,
      "Version": 5,
      "Level": 4,
      "Task": 1,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-09T06:01:33.872822000Z",
      "EventRecordID": 87355,
      "ProcessID": "8040",
      "ThreadID": "8040",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-09 05:33:18.487",
      "ProcessGuid": "{8b8a9dc4-931e-6960-2d33-6b3430590000}",
      "Image": "/usr/bin/bash",
      "User": "root",
      "OriginalLogfile": "Linux_Base64_Encoded_Pipe_to_Shell_attack15.log-QJ5TVKCT.json",
      "FileVersion": "-",
      "Description": "-",
      "Product": "-",
      "Company": "-",
      "OriginalFileName": "-",
      "CommandLine": "/bin/bash -c echo \"ZWNobyAiVHJpZ2dlcmluZyBTaWdtYSBSdWxlIiA7IGlkCg==\" | base64 -d |/bin/sh;:",
      "CurrentDirectory": "/home/vincenzolog/Auto_test",
      "LogonGuid": "{8b8a9dc4-0000-0000-0000-000006000000}",
      "LogonId": 0,
      "TerminalSessionId": 3,
      "IntegrityLevel": "no level",
      "SHA256": "bc5945feb8bd26203ebfafea5ce1878bb2e32cb8fb50ab7ae395cfb1e1aaaef1",
      "Hashes": "SHA256=bc5945feb8bd26203ebfafea5ce1878bb2e32cb8fb50ab7ae395cfb1e1aaaef1",
      "ParentProcessGuid": "{8b8a9dc4-931e-6960-1d98-7ee1a9570000}",
      "ParentProcessId": 10224,
      "ParentImage": "/usr/bin/dash",
      "ParentCommandLine": "/bin/sh",
      "ParentUser": "root"
    }
  ]
}]