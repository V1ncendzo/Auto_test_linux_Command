[{
  "title": "OS Architecture Discovery Via Grep (Hardened)",
  "id": "d27ab432-2199-483f-a297-03633c05bae6",
  "description": "Detects the use of grep to identify information about the operating system architecture. \nEnhanced to detect flags reordering and regex obfuscation.\n",
  "sigmafile": "",
  "sigma": [
    "SELECT * FROM logs WHERE Image LIKE '%/grep' ESCAPE '\\' AND ((CommandLine LIKE '%x86\\_64%' ESCAPE '\\' OR CommandLine LIKE '%aarch64%' ESCAPE '\\' OR CommandLine LIKE '%i686%' ESCAPE '\\' OR CommandLine LIKE '%mips%' ESCAPE '\\' OR CommandLine LIKE '% i386%' ESCAPE '\\' OR CommandLine LIKE '% arm%' ESCAPE '\\') OR (CommandLine REGEXP 'x86[\\._]64' OR CommandLine REGEXP '\\[x\\]86_64' OR CommandLine REGEXP 'x86\\[_\\]64'))"
  ],
  "rule_level": "medium",
  "tags": [
    "attack.discovery",
    "attack.t1082"
  ],
  "count": 1,
  "matches": [
    {
      "row_id": 9,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 1,
      "Version": 5,
      "Level": 4,
      "Task": 1,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-13T05:31:07.052015000Z",
      "EventRecordID": 478736,
      "ProcessID": "5412",
      "ThreadID": "5412",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-12 08:24:38.441",
      "ProcessGuid": "{8b8a9dc4-afc6-6964-3133-0f4e11650000}",
      "Image": "/usr/bin/grep",
      "User": "root",
      "OriginalLogfile": "OS_Architecture_Discovery_Via_Grep_attack128.log-B3CZ9Q0R.json",
      "FileVersion": "-",
      "Description": "-",
      "Product": "-",
      "Company": "-",
      "OriginalFileName": "-",
      "CommandLine": "grep x86_64 /etc/os-release",
      "CurrentDirectory": "/home/vincenzolog/Auto_test",
      "LogonGuid": "{8b8a9dc4-0000-0000-0000-000004000000}",
      "LogonId": 0,
      "TerminalSessionId": 3,
      "IntegrityLevel": "no level",
      "SHA256": "20a35a4c18f2fe9e6305c1cbf866b9c0fcc3f957132ae66028c99ec353bb0a80",
      "Hashes": "SHA256=20a35a4c18f2fe9e6305c1cbf866b9c0fcc3f957132ae66028c99ec353bb0a80",
      "ParentProcessGuid": "{8b8a9dc4-afc6-6964-1d88-cd4ecc5c0000}",
      "ParentProcessId": 138939,
      "ParentImage": "/usr/bin/dash",
      "ParentCommandLine": "/bin/sh",
      "ParentUser": "root"
    }
  ]
}]