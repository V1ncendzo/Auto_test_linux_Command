[{
  "title": "Linux Crypto Mining Indicators (Enhanced)",
  "id": "9069ea3c-b213-4c52-be13-86506a227ab1",
  "description": "Detects command line parameters or strings often used by crypto miners, robust against simple obfuscation.",
  "sigmafile": "",
  "sigma": [
    "SELECT * FROM logs WHERE (CommandLine LIKE '% --cpu-priority=%' ESCAPE '\\' OR CommandLine LIKE '%--donate-level=0%' ESCAPE '\\' OR CommandLine LIKE '% -o pool.%' ESCAPE '\\' OR CommandLine LIKE '% --nicehash%' ESCAPE '\\' OR CommandLine LIKE '% --algo=rx/0 %' ESCAPE '\\' OR CommandLine LIKE '%stratum+tcp://%' ESCAPE '\\' OR CommandLine LIKE '%stratum+udp://%' ESCAPE '\\') OR (CommandLine LIKE '%modprobe%' ESCAPE '\\' AND CommandLine LIKE '%msr%' ESCAPE '\\' AND CommandLine LIKE '%allow\\_writes%' ESCAPE '\\') OR (CommandLine LIKE '%LS1kb25hdGUtbGV2ZWw9%' ESCAPE '\\' OR CommandLine LIKE '%0tZG9uYXRlLWxldmVsP%' ESCAPE '\\' OR CommandLine LIKE '%c3RyYXR1bSt0Y3A6Ly%' ESCAPE '\\')"
  ],
  "rule_level": "high",
  "tags": [
    "attack.impact",
    "attack.t1496"
  ],
  "count": 5,
  "matches": [
    {
      "row_id": 9,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 1,
      "Version": 5,
      "Level": 4,
      "Task": 1,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-09T16:13:12.000965000Z",
      "EventRecordID": 269481,
      "ProcessID": "120528",
      "ThreadID": "120528",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-09 16:13:12.000",
      "ProcessGuid": "{8b8a9dc4-2918-6961-1d88-8eaa8e5e0000}",
      "Image": "/usr/bin/dash",
      "User": "root",
      "OriginalLogfile": "Linux_Crypto_Mining_Indicators_attack138.log-TE4WTVLW.json",
      "FileVersion": "-",
      "Description": "-",
      "Product": "-",
      "Company": "-",
      "OriginalFileName": "-",
      "CommandLine": "/bin/sh -c sudo sh -c 'bash -c \"/sbin/modprobe msr allow_writes=on\"'",
      "CurrentDirectory": "/home/vincenzolog/Auto_test",
      "LogonGuid": "{8b8a9dc4-0000-0000-0000-000005000000}",
      "LogonId": 0,
      "TerminalSessionId": 3,
      "IntegrityLevel": "no level",
      "SHA256": "86d31f6fb799e91fa21bad341484564510ca287703a16e9e46c53338776f4f42",
      "Hashes": "SHA256=86d31f6fb799e91fa21bad341484564510ca287703a16e9e46c53338776f4f42",
      "ParentProcessGuid": "{8b8a9dc4-26dc-6961-1d23-700000000000}",
      "ParentProcessId": 120578,
      "ParentImage": "/usr/bin/python3.12",
      "ParentCommandLine": "python3",
      "ParentUser": "root"
    },
    {
      "row_id": 10,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 1,
      "Version": 5,
      "Level": 4,
      "Task": 1,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-09T16:13:12.002703000Z",
      "EventRecordID": 269482,
      "ProcessID": "120528",
      "ThreadID": "120528",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-09 16:13:12.002",
      "ProcessGuid": "{8b8a9dc4-2918-6961-d12b-e6fe065d0000}",
      "Image": "/usr/bin/sudo",
      "User": "root",
      "OriginalLogfile": "Linux_Crypto_Mining_Indicators_attack138.log-TE4WTVLW.json",
      "FileVersion": "-",
      "Description": "-",
      "Product": "-",
      "Company": "-",
      "OriginalFileName": "-",
      "CommandLine": "sudo sh -c bash -c \"/sbin/modprobe msr allow_writes=on\"",
      "CurrentDirectory": "/home/vincenzolog/Auto_test",
      "LogonGuid": "{8b8a9dc4-0000-0000-0000-000005000000}",
      "LogonId": 0,
      "TerminalSessionId": 3,
      "IntegrityLevel": "no level",
      "SHA256": "654d953098b5dd26fcc3af44d4cf6e986f61f84ad9198d57722702c6034bd686",
      "Hashes": "SHA256=654d953098b5dd26fcc3af44d4cf6e986f61f84ad9198d57722702c6034bd686",
      "ParentProcessGuid": "{8b8a9dc4-2918-6961-1d88-8eaa8e5e0000}",
      "ParentProcessId": 125166,
      "ParentImage": "/usr/bin/dash",
      "ParentCommandLine": "/bin/sh",
      "ParentUser": "root"
    },
    {
      "row_id": 11,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 1,
      "Version": 5,
      "Level": 4,
      "Task": 1,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-09T16:13:12.012375000Z",
      "EventRecordID": 269483,
      "ProcessID": "120528",
      "ThreadID": "120528",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-09 16:13:12.011",
      "ProcessGuid": "{8b8a9dc4-2918-6961-1d48-a9db0d620000}",
      "Image": "/usr/bin/dash",
      "User": "root",
      "OriginalLogfile": "Linux_Crypto_Mining_Indicators_attack138.log-TE4WTVLW.json",
      "FileVersion": "-",
      "Description": "-",
      "Product": "-",
      "Company": "-",
      "OriginalFileName": "-",
      "CommandLine": "sh -c bash -c \"/sbin/modprobe msr allow_writes=on\"",
      "CurrentDirectory": "/home/vincenzolog/Auto_test",
      "LogonGuid": "{8b8a9dc4-2918-6961-0000-000006000000}",
      "LogonId": 0,
      "TerminalSessionId": 3,
      "IntegrityLevel": "no level",
      "SHA256": "86d31f6fb799e91fa21bad341484564510ca287703a16e9e46c53338776f4f42",
      "Hashes": "SHA256=86d31f6fb799e91fa21bad341484564510ca287703a16e9e46c53338776f4f42",
      "ParentProcessGuid": "{00000000-0000-0000-0000-000000000000}",
      "ParentProcessId": 125168,
      "ParentImage": "-",
      "ParentCommandLine": "-",
      "ParentUser": "-"
    },
    {
      "row_id": 12,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 1,
      "Version": 5,
      "Level": 4,
      "Task": 1,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-09T16:13:12.015301000Z",
      "EventRecordID": 269484,
      "ProcessID": "120528",
      "ThreadID": "120528",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-09 16:13:12.014",
      "ProcessGuid": "{8b8a9dc4-2918-6961-2dd3-c1af805b0000}",
      "Image": "/usr/bin/bash",
      "User": "root",
      "OriginalLogfile": "Linux_Crypto_Mining_Indicators_attack138.log-TE4WTVLW.json",
      "FileVersion": "-",
      "Description": "-",
      "Product": "-",
      "Company": "-",
      "OriginalFileName": "-",
      "CommandLine": "bash -c /sbin/modprobe msr allow_writes=on",
      "CurrentDirectory": "/home/vincenzolog/Auto_test",
      "LogonGuid": "{8b8a9dc4-2918-6961-0000-000006000000}",
      "LogonId": 0,
      "TerminalSessionId": 3,
      "IntegrityLevel": "no level",
      "SHA256": "bc5945feb8bd26203ebfafea5ce1878bb2e32cb8fb50ab7ae395cfb1e1aaaef1",
      "Hashes": "SHA256=bc5945feb8bd26203ebfafea5ce1878bb2e32cb8fb50ab7ae395cfb1e1aaaef1",
      "ParentProcessGuid": "{8b8a9dc4-2918-6961-1d48-a9db0d620000}",
      "ParentProcessId": 125169,
      "ParentImage": "/usr/bin/dash",
      "ParentCommandLine": "sh",
      "ParentUser": "root"
    },
    {
      "row_id": 13,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 1,
      "Version": 5,
      "Level": 4,
      "Task": 1,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-09T16:13:12.016091000Z",
      "EventRecordID": 269485,
      "ProcessID": "120528",
      "ThreadID": "120528",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-09 16:13:12.014",
      "ProcessGuid": "{8b8a9dc4-2918-6961-8521-877212600000}",
      "Image": "/usr/bin/kmod",
      "User": "root",
      "OriginalLogfile": "Linux_Crypto_Mining_Indicators_attack138.log-TE4WTVLW.json",
      "FileVersion": "-",
      "Description": "-",
      "Product": "-",
      "Company": "-",
      "OriginalFileName": "-",
      "CommandLine": "/sbin/modprobe msr allow_writes=on",
      "CurrentDirectory": "/home/vincenzolog/Auto_test",
      "LogonGuid": "{8b8a9dc4-2918-6961-0000-000006000000}",
      "LogonId": 0,
      "TerminalSessionId": 3,
      "IntegrityLevel": "no level",
      "SHA256": "0f1f5e63a070f3519fa1cabc18646d001531e5c250443bd30739347c9be1069f",
      "Hashes": "SHA256=0f1f5e63a070f3519fa1cabc18646d001531e5c250443bd30739347c9be1069f",
      "ParentProcessGuid": "{8b8a9dc4-2918-6961-1d48-a9db0d620000}",
      "ParentProcessId": 125169,
      "ParentImage": "/usr/bin/dash",
      "ParentCommandLine": "sh",
      "ParentUser": "root"
    }
  ]
}]