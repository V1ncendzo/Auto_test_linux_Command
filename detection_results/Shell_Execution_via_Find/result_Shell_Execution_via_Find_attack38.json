[{
  "title": "Syslog Clearing or Removal Via System Utilities",
  "id": "3fcc9b35-39e4-44c0-a2ad-9e82b6902b31",
  "description": "Detects specific commands commonly used to remove or empty the syslog. Which is a technique often used by attacker as a method to hide their tracks\n",
  "sigmafile": "",
  "sigma": [
    "SELECT * FROM logs WHERE (CommandLine LIKE '%/var/log/syslog%' ESCAPE '\\' AND ((Image LIKE '%/rm' ESCAPE '\\' AND (CommandLine LIKE '% -r %' ESCAPE '\\' OR CommandLine LIKE '% -f %' ESCAPE '\\' OR CommandLine LIKE '% -rf %' ESCAPE '\\' OR CommandLine LIKE '%/var/log/syslog%' ESCAPE '\\')) OR Image LIKE '%/unlink' ESCAPE '\\' OR Image LIKE '%/mv' ESCAPE '\\' OR (Image LIKE '%/truncate' ESCAPE '\\' AND (CommandLine LIKE '%0 %' ESCAPE '\\' AND CommandLine LIKE '%/var/log/syslog%' ESCAPE '\\') AND (CommandLine LIKE '%-s %' ESCAPE '\\' OR CommandLine LIKE '%-c %' ESCAPE '\\' OR CommandLine LIKE '%--size%' ESCAPE '\\')) OR (Image LIKE '%/ln' ESCAPE '\\' AND (CommandLine LIKE '%/dev/null %' ESCAPE '\\' AND CommandLine LIKE '%/var/log/syslog%' ESCAPE '\\') AND (CommandLine LIKE '%-sf %' ESCAPE '\\' OR CommandLine LIKE '%-sfn %' ESCAPE '\\' OR CommandLine LIKE '%-sfT %' ESCAPE '\\')) OR (Image LIKE '%/cp' ESCAPE '\\' AND CommandLine LIKE '%/dev/null%' ESCAPE '\\') OR (Image LIKE '%/shred' ESCAPE '\\' AND CommandLine LIKE '%-u %' ESCAPE '\\'))) OR ((CommandLine LIKE '% > /var/log/syslog%' ESCAPE '\\' OR CommandLine LIKE '% >/var/log/syslog%' ESCAPE '\\' OR CommandLine LIKE '% >| /var/log/syslog%' ESCAPE '\\' OR CommandLine LIKE '%: > /var/log/syslog%' ESCAPE '\\' OR CommandLine LIKE '%:> /var/log/syslog%' ESCAPE '\\' OR CommandLine LIKE '%:>/var/log/syslog%' ESCAPE '\\' OR CommandLine LIKE '%>|/var/log/syslog%' ESCAPE '\\') OR (CommandLine LIKE '%journalctl --vacuum%' ESCAPE '\\' OR CommandLine LIKE '%journalctl --rotate%' ESCAPE '\\'))"
  ],
  "rule_level": "high",
  "tags": [
    "attack.defense-evasion",
    "attack.t1070.002"
  ],
  "count": 2,
  "matches": [
    {
      "row_id": 36,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 1,
      "Version": 5,
      "Level": 4,
      "Task": 1,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-16T17:07:13.174139000Z",
      "EventRecordID": 977254,
      "ProcessID": "1624",
      "ThreadID": "1624",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-16 16:08:35.808",
      "ProcessGuid": "{8b8a9dc4-6283-696a-1d58-373ee75b0000}",
      "Image": "/usr/bin/dash",
      "User": "root",
      "OriginalLogfile": "Shell_Execution_via_Find_attack38.log-PXJ0HTOK.json",
      "FileVersion": "-",
      "Description": "-",
      "Product": "-",
      "Company": "-",
      "OriginalFileName": "-",
      "CommandLine": "/bin/sh -c journalctl --vacuum-time=1s",
      "CurrentDirectory": "/home/vincenzolog/Auto_test",
      "LogonGuid": "{8b8a9dc4-0000-0000-0000-000005000000}",
      "LogonId": 0,
      "TerminalSessionId": 3,
      "IntegrityLevel": "no level",
      "SHA256": "86d31f6fb799e91fa21bad341484564510ca287703a16e9e46c53338776f4f42",
      "Hashes": "SHA256=86d31f6fb799e91fa21bad341484564510ca287703a16e9e46c53338776f4f42",
      "ParentProcessGuid": "{8b8a9dc4-612c-696a-dd23-700000000000}",
      "ParentProcessId": 120295,
      "ParentImage": "/usr/bin/python3.12",
      "ParentCommandLine": "python3",
      "ParentUser": "root"
    },
    {
      "row_id": 42,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 1,
      "Version": 5,
      "Level": 4,
      "Task": 1,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-16T17:07:13.190751000Z",
      "EventRecordID": 977260,
      "ProcessID": "1624",
      "ThreadID": "1624",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-16 16:08:35.841",
      "ProcessGuid": "{8b8a9dc4-6283-696a-cd5b-58e6ef580000}",
      "Image": "/usr/bin/journalctl",
      "User": "root",
      "OriginalLogfile": "Shell_Execution_via_Find_attack38.log-PXJ0HTOK.json",
      "FileVersion": "-",
      "Description": "-",
      "Product": "-",
      "Company": "-",
      "OriginalFileName": "-",
      "CommandLine": "journalctl --vacuum-time=1s",
      "CurrentDirectory": "/home/vincenzolog/Auto_test",
      "LogonGuid": "{8b8a9dc4-0000-0000-0000-000005000000}",
      "LogonId": 0,
      "TerminalSessionId": 3,
      "IntegrityLevel": "no level",
      "SHA256": "7bd10a9c601c3204a6c464fc517b204e469eca7f12b09f9c4826f3cc1e42bd79",
      "Hashes": "SHA256=7bd10a9c601c3204a6c464fc517b204e469eca7f12b09f9c4826f3cc1e42bd79",
      "ParentProcessGuid": "{8b8a9dc4-6283-696a-1d58-373ee75b0000}",
      "ParentProcessId": 171264,
      "ParentImage": "/usr/bin/dash",
      "ParentCommandLine": "/bin/sh",
      "ParentUser": "root"
    }
  ]
},
{
  "title": "Shell Execution via Find - Linux",
  "id": "6adfbf8f-52be-4444-9bac-81b539624146",
  "description": "Detects the use of the find command to execute a shell. Such behavior may be associated with privilege escalation, unauthorized command execution, or exploitation attempt.\n",
  "sigmafile": "",
  "sigma": [
    "SELECT * FROM logs WHERE (Image LIKE '%/find' ESCAPE '\\' AND (CommandLine LIKE '% . %' ESCAPE '\\' AND CommandLine LIKE '%-exec%' ESCAPE '\\')) AND (CommandLine LIKE '%/bin/bash%' ESCAPE '\\' OR CommandLine LIKE '%/bin/dash%' ESCAPE '\\' OR CommandLine LIKE '%/bin/fish%' ESCAPE '\\' OR CommandLine LIKE '%/bin/sh%' ESCAPE '\\' OR CommandLine LIKE '%/bin/zsh%' ESCAPE '\\')"
  ],
  "rule_level": "high",
  "tags": [
    "attack.discovery",
    "attack.t1083"
  ],
  "count": 1,
  "matches": [
    {
      "row_id": 852,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 1,
      "Version": 5,
      "Level": 4,
      "Task": 1,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-16T17:07:14.235801000Z",
      "EventRecordID": 978070,
      "ProcessID": "1624",
      "ThreadID": "1624",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-16 16:08:36.883",
      "ProcessGuid": "{8b8a9dc4-6284-696a-c1cc-37a896570000}",
      "Image": "/usr/bin/find",
      "User": "root",
      "OriginalLogfile": "Shell_Execution_via_Find_attack38.log-PXJ0HTOK.json",
      "FileVersion": "-",
      "Description": "-",
      "Product": "-",
      "Company": "-",
      "OriginalFileName": "-",
      "CommandLine": "find . -exec /bin/sh ; -q\\u\\it",
      "CurrentDirectory": "/home/vincenzolog/Auto_test",
      "LogonGuid": "{8b8a9dc4-0000-0000-0000-000005000000}",
      "LogonId": 0,
      "TerminalSessionId": 3,
      "IntegrityLevel": "no level",
      "SHA256": "ac1ea1c5391de921aca1572f1bf25d03707beb3887b27c16a5b4948fd553941b",
      "Hashes": "SHA256=ac1ea1c5391de921aca1572f1bf25d03707beb3887b27c16a5b4948fd553941b",
      "ParentProcessGuid": "{8b8a9dc4-6284-696a-1df8-36ef435f0000}",
      "ParentProcessId": 172062,
      "ParentImage": "/usr/bin/dash",
      "ParentCommandLine": "/bin/sh",
      "ParentUser": "root"
    }
  ]
},
{
  "title": "File and Directory Discovery - Linux",
  "id": "d3feb4ee-ff1d-4d3d-bd10-5b28a238cc72",
  "description": "Detects usage of system utilities such as \"find\", \"tree\", \"findmnt\", etc, to discover files, directories and network shares.\n",
  "sigmafile": "",
  "sigma": [
    "SELECT * FROM logs WHERE (Image LIKE '%/file' ESCAPE '\\' AND CommandLine REGEXP '(.){200,}') OR (Image LIKE '%/ls' ESCAPE '\\' AND CommandLine LIKE '%-R%' ESCAPE '\\') OR Image LIKE '%/find' ESCAPE '\\' OR Image LIKE '%/tree' ESCAPE '\\' OR Image LIKE '%/findmnt' ESCAPE '\\' OR Image LIKE '%/mlocate' ESCAPE '\\'"
  ],
  "rule_level": "informational",
  "tags": [
    "attack.discovery",
    "attack.t1083"
  ],
  "count": 7,
  "matches": [
    {
      "row_id": 248,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 1,
      "Version": 5,
      "Level": 4,
      "Task": 1,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-16T17:07:13.569023000Z",
      "EventRecordID": 977466,
      "ProcessID": "1624",
      "ThreadID": "1624",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-16 16:08:36.206",
      "ProcessGuid": "{8b8a9dc4-6284-696a-c1bc-8e46bd5f0000}",
      "Image": "/usr/bin/find",
      "User": "root",
      "OriginalLogfile": "Shell_Execution_via_Find_attack38.log-PXJ0HTOK.json",
      "FileVersion": "-",
      "Description": "-",
      "Product": "-",
      "Company": "-",
      "OriginalFileName": "-",
      "CommandLine": "find /var/log/sysstat -type f -mtime +7",
      "CurrentDirectory": "/usr/bin",
      "LogonGuid": "{8b8a9dc4-0000-0000-0000-000000000000}",
      "LogonId": 0,
      "TerminalSessionId": 4294967295,
      "IntegrityLevel": "no level",
      "SHA256": "ac1ea1c5391de921aca1572f1bf25d03707beb3887b27c16a5b4948fd553941b",
      "Hashes": "SHA256=ac1ea1c5391de921aca1572f1bf25d03707beb3887b27c16a5b4948fd553941b",
      "ParentProcessGuid": "{8b8a9dc4-6283-696a-a933-1b715a5c0000}",
      "ParentProcessId": 171226,
      "ParentImage": "/usr/lib/systemd/systemd-executor",
      "ParentCommandLine": "/usr/lib/systemd/systemd-executor",
      "ParentUser": "root"
    },
    {
      "row_id": 257,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 5,
      "Version": 3,
      "Level": 4,
      "Task": 5,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-16T17:07:13.575804000Z",
      "EventRecordID": 977475,
      "ProcessID": "1624",
      "ThreadID": "1624",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-16 16:08:36.229",
      "ProcessGuid": "{8b8a9dc4-6284-696a-c1bc-8e46bd5f0000}",
      "Image": "/usr/bin/find",
      "User": "root",
      "OriginalLogfile": "Shell_Execution_via_Find_attack38.log-PXJ0HTOK.json"
    },
    {
      "row_id": 269,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 1,
      "Version": 5,
      "Level": 4,
      "Task": 1,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-16T17:07:13.593059000Z",
      "EventRecordID": 977487,
      "ProcessID": "1624",
      "ThreadID": "1624",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-16 16:08:36.235",
      "ProcessGuid": "{8b8a9dc4-6284-696a-c19c-6e3343640000}",
      "Image": "/usr/bin/find",
      "User": "root",
      "OriginalLogfile": "Shell_Execution_via_Find_attack38.log-PXJ0HTOK.json",
      "FileVersion": "-",
      "Description": "-",
      "Product": "-",
      "Company": "-",
      "OriginalFileName": "-",
      "CommandLine": "find /var/log/sysstat -type f -mtime +10",
      "CurrentDirectory": "/usr/bin",
      "LogonGuid": "{8b8a9dc4-0000-0000-0000-000000000000}",
      "LogonId": 0,
      "TerminalSessionId": 4294967295,
      "IntegrityLevel": "no level",
      "SHA256": "ac1ea1c5391de921aca1572f1bf25d03707beb3887b27c16a5b4948fd553941b",
      "Hashes": "SHA256=ac1ea1c5391de921aca1572f1bf25d03707beb3887b27c16a5b4948fd553941b",
      "ParentProcessGuid": "{8b8a9dc4-6283-696a-a933-1b715a5c0000}",
      "ParentProcessId": 171226,
      "ParentImage": "/usr/lib/systemd/systemd-executor",
      "ParentCommandLine": "/usr/lib/systemd/systemd-executor",
      "ParentUser": "root"
    },
    {
      "row_id": 270,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 5,
      "Version": 3,
      "Level": 4,
      "Task": 5,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-16T17:07:13.594069000Z",
      "EventRecordID": 977488,
      "ProcessID": "1624",
      "ThreadID": "1624",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-16 16:08:36.246",
      "ProcessGuid": "{8b8a9dc4-6284-696a-c19c-6e3343640000}",
      "Image": "/usr/bin/find",
      "User": "root",
      "OriginalLogfile": "Shell_Execution_via_Find_attack38.log-PXJ0HTOK.json"
    },
    {
      "row_id": 496,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 5,
      "Version": 3,
      "Level": 4,
      "Task": 5,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-16T17:07:13.868794000Z",
      "EventRecordID": 977714,
      "ProcessID": "1624",
      "ThreadID": "1624",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-16 16:08:36.520",
      "ProcessGuid": "{8b8a9dc4-6240-696a-c1dc-93b2af570000}",
      "Image": "/usr/bin/find",
      "User": "root",
      "OriginalLogfile": "Shell_Execution_via_Find_attack38.log-PXJ0HTOK.json"
    },
    {
      "row_id": 852,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 1,
      "Version": 5,
      "Level": 4,
      "Task": 1,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-16T17:07:14.235801000Z",
      "EventRecordID": 978070,
      "ProcessID": "1624",
      "ThreadID": "1624",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-16 16:08:36.883",
      "ProcessGuid": "{8b8a9dc4-6284-696a-c1cc-37a896570000}",
      "Image": "/usr/bin/find",
      "User": "root",
      "OriginalLogfile": "Shell_Execution_via_Find_attack38.log-PXJ0HTOK.json",
      "FileVersion": "-",
      "Description": "-",
      "Product": "-",
      "Company": "-",
      "OriginalFileName": "-",
      "CommandLine": "find . -exec /bin/sh ; -q\\u\\it",
      "CurrentDirectory": "/home/vincenzolog/Auto_test",
      "LogonGuid": "{8b8a9dc4-0000-0000-0000-000005000000}",
      "LogonId": 0,
      "TerminalSessionId": 3,
      "IntegrityLevel": "no level",
      "SHA256": "ac1ea1c5391de921aca1572f1bf25d03707beb3887b27c16a5b4948fd553941b",
      "Hashes": "SHA256=ac1ea1c5391de921aca1572f1bf25d03707beb3887b27c16a5b4948fd553941b",
      "ParentProcessGuid": "{8b8a9dc4-6284-696a-1df8-36ef435f0000}",
      "ParentProcessId": 172062,
      "ParentImage": "/usr/bin/dash",
      "ParentCommandLine": "/bin/sh",
      "ParentUser": "root"
    },
    {
      "row_id": 858,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 5,
      "Version": 3,
      "Level": 4,
      "Task": 5,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-16T17:07:14.240711000Z",
      "EventRecordID": 978076,
      "ProcessID": "1624",
      "ThreadID": "1624",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-16 16:08:36.892",
      "ProcessGuid": "{8b8a9dc4-6284-696a-c1cc-37a896570000}",
      "Image": "/usr/bin/find",
      "User": "root",
      "OriginalLogfile": "Shell_Execution_via_Find_attack38.log-PXJ0HTOK.json"
    }
  ]
},
{
  "title": "File Deletion",
  "id": "30aed7b6-d2c1-4eaf-9382-b6bc43e50c57",
  "description": "Detects file deletion using \"rm\", \"shred\" or \"unlink\" commands which are used often by adversaries to delete files left behind by the actions of their intrusion activity",
  "sigmafile": "",
  "sigma": [
    "SELECT * FROM logs WHERE Image LIKE '%/rm' ESCAPE '\\' OR Image LIKE '%/shred' ESCAPE '\\' OR Image LIKE '%/unlink' ESCAPE '\\'"
  ],
  "rule_level": "informational",
  "tags": [
    "attack.defense-evasion",
    "attack.t1070.004"
  ],
  "count": 2,
  "matches": [
    {
      "row_id": 259,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 1,
      "Version": 5,
      "Level": 4,
      "Task": 1,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-16T17:07:13.579331000Z",
      "EventRecordID": 977477,
      "ProcessID": "1624",
      "ThreadID": "1624",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-16 16:08:36.228",
      "ProcessGuid": "{8b8a9dc4-6284-696a-413a-42a2be560000}",
      "Image": "/usr/bin/rm",
      "User": "root",
      "OriginalLogfile": "Shell_Execution_via_Find_attack38.log-PXJ0HTOK.json",
      "FileVersion": "-",
      "Description": "-",
      "Product": "-",
      "Company": "-",
      "OriginalFileName": "-",
      "CommandLine": "rm -f",
      "CurrentDirectory": "/usr/bin",
      "LogonGuid": "{8b8a9dc4-0000-0000-0000-000000000000}",
      "LogonId": 0,
      "TerminalSessionId": 4294967295,
      "IntegrityLevel": "no level",
      "SHA256": "8e3faaa5eb4a2a4d0e2788fe442bcac6d604be5a0c5a9f09d08f06e3a3fcf570",
      "Hashes": "SHA256=8e3faaa5eb4a2a4d0e2788fe442bcac6d604be5a0c5a9f09d08f06e3a3fcf570",
      "ParentProcessGuid": "{8b8a9dc4-6284-696a-b165-e39c91570000}",
      "ParentProcessId": 171476,
      "ParentImage": "/usr/bin/xargs",
      "ParentCommandLine": "xargs",
      "ParentUser": "root"
    },
    {
      "row_id": 264,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 5,
      "Version": 3,
      "Level": 4,
      "Task": 5,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-16T17:07:13.583820000Z",
      "EventRecordID": 977482,
      "ProcessID": "1624",
      "ThreadID": "1624",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-16 16:08:36.233",
      "ProcessGuid": "{8b8a9dc4-6284-696a-413a-42a2be560000}",
      "Image": "/usr/bin/rm",
      "User": "root",
      "OriginalLogfile": "Shell_Execution_via_Find_attack38.log-PXJ0HTOK.json"
    }
  ]
}]