[{
  "title": "Syslog Clearing or Removal Via System Utilities",
  "id": "3fcc9b35-39e4-44c0-a2ad-9e82b6902b31",
  "description": "Detects specific commands commonly used to remove or empty the syslog. Which is a technique often used by attacker as a method to hide their tracks\n",
  "sigmafile": "",
  "sigma": [
    "SELECT * FROM logs WHERE (CommandLine LIKE '%/var/log/syslog%' ESCAPE '\\' AND ((Image LIKE '%/rm' ESCAPE '\\' AND (CommandLine LIKE '% -r %' ESCAPE '\\' OR CommandLine LIKE '% -f %' ESCAPE '\\' OR CommandLine LIKE '% -rf %' ESCAPE '\\' OR CommandLine LIKE '%/var/log/syslog%' ESCAPE '\\')) OR Image LIKE '%/unlink' ESCAPE '\\' OR Image LIKE '%/mv' ESCAPE '\\' OR (Image LIKE '%/truncate' ESCAPE '\\' AND (CommandLine LIKE '%0 %' ESCAPE '\\' AND CommandLine LIKE '%/var/log/syslog%' ESCAPE '\\') AND (CommandLine LIKE '%-s %' ESCAPE '\\' OR CommandLine LIKE '%-c %' ESCAPE '\\' OR CommandLine LIKE '%--size%' ESCAPE '\\')) OR (Image LIKE '%/ln' ESCAPE '\\' AND (CommandLine LIKE '%/dev/null %' ESCAPE '\\' AND CommandLine LIKE '%/var/log/syslog%' ESCAPE '\\') AND (CommandLine LIKE '%-sf %' ESCAPE '\\' OR CommandLine LIKE '%-sfn %' ESCAPE '\\' OR CommandLine LIKE '%-sfT %' ESCAPE '\\')) OR (Image LIKE '%/cp' ESCAPE '\\' AND CommandLine LIKE '%/dev/null%' ESCAPE '\\') OR (Image LIKE '%/shred' ESCAPE '\\' AND CommandLine LIKE '%-u %' ESCAPE '\\'))) OR ((CommandLine LIKE '% > /var/log/syslog%' ESCAPE '\\' OR CommandLine LIKE '% >/var/log/syslog%' ESCAPE '\\' OR CommandLine LIKE '% >| /var/log/syslog%' ESCAPE '\\' OR CommandLine LIKE '%: > /var/log/syslog%' ESCAPE '\\' OR CommandLine LIKE '%:> /var/log/syslog%' ESCAPE '\\' OR CommandLine LIKE '%:>/var/log/syslog%' ESCAPE '\\' OR CommandLine LIKE '%>|/var/log/syslog%' ESCAPE '\\') OR (CommandLine LIKE '%journalctl --vacuum%' ESCAPE '\\' OR CommandLine LIKE '%journalctl --rotate%' ESCAPE '\\'))"
  ],
  "rule_level": "high",
  "tags": [
    "attack.defense-evasion",
    "attack.t1070.002"
  ],
  "count": 2,
  "matches": [
    {
      "row_id": 4,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 1,
      "Version": 5,
      "Level": 4,
      "Task": 1,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-16T12:51:48.169754000Z",
      "EventRecordID": 796931,
      "ProcessID": "1624",
      "ThreadID": "1624",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-16 12:51:48.875",
      "ProcessGuid": "{8b8a9dc4-3464-696a-1dd8-cb0092630000}",
      "Image": "/usr/bin/dash",
      "User": "root",
      "OriginalLogfile": "Kaspersky_Endpoint_Security_Stopped_Via_CommandLine_attack218.log-NS64GTF4.json",
      "FileVersion": "-",
      "Description": "-",
      "Product": "-",
      "Company": "-",
      "OriginalFileName": "-",
      "CommandLine": "/bin/sh -c journalctl --vacuum-time=1s",
      "CurrentDirectory": "/home/vincenzolog/Auto_test",
      "LogonGuid": "{8b8a9dc4-0000-0000-0000-000003000000}",
      "LogonId": 0,
      "TerminalSessionId": 3,
      "IntegrityLevel": "no level",
      "SHA256": "86d31f6fb799e91fa21bad341484564510ca287703a16e9e46c53338776f4f42",
      "Hashes": "SHA256=86d31f6fb799e91fa21bad341484564510ca287703a16e9e46c53338776f4f42",
      "ParentProcessGuid": "{8b8a9dc4-30cf-696a-dd23-700000000000}",
      "ParentProcessId": 12362,
      "ParentImage": "/usr/bin/python3.12",
      "ParentCommandLine": "python3",
      "ParentUser": "root"
    },
    {
      "row_id": 5,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 1,
      "Version": 5,
      "Level": 4,
      "Task": 1,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-16T12:51:48.171991000Z",
      "EventRecordID": 796932,
      "ProcessID": "1624",
      "ThreadID": "1624",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-16 12:51:48.878",
      "ProcessGuid": "{8b8a9dc4-3464-696a-cdbb-4783d9620000}",
      "Image": "/usr/bin/journalctl",
      "User": "root",
      "OriginalLogfile": "Kaspersky_Endpoint_Security_Stopped_Via_CommandLine_attack218.log-NS64GTF4.json",
      "FileVersion": "-",
      "Description": "-",
      "Product": "-",
      "Company": "-",
      "OriginalFileName": "-",
      "CommandLine": "journalctl --vacuum-time=1s",
      "CurrentDirectory": "/home/vincenzolog/Auto_test",
      "LogonGuid": "{8b8a9dc4-0000-0000-0000-000003000000}",
      "LogonId": 0,
      "TerminalSessionId": 3,
      "IntegrityLevel": "no level",
      "SHA256": "7bd10a9c601c3204a6c464fc517b204e469eca7f12b09f9c4826f3cc1e42bd79",
      "Hashes": "SHA256=7bd10a9c601c3204a6c464fc517b204e469eca7f12b09f9c4826f3cc1e42bd79",
      "ParentProcessGuid": "{8b8a9dc4-3464-696a-1dd8-cb0092630000}",
      "ParentProcessId": 32356,
      "ParentImage": "/usr/bin/dash",
      "ParentCommandLine": "/bin/sh",
      "ParentUser": "root"
    }
  ]
},
{
  "title": "System Information Discovery",
  "id": "42df45e7-e6e9-43b5-8f26-bec5b39cc239",
  "description": "Detects system information discovery commands",
  "sigmafile": "",
  "sigma": [
    "SELECT * FROM logs WHERE Image LIKE '%/uname' ESCAPE '\\' OR Image LIKE '%/hostname' ESCAPE '\\' OR Image LIKE '%/uptime' ESCAPE '\\' OR Image LIKE '%/lspci' ESCAPE '\\' OR Image LIKE '%/dmidecode' ESCAPE '\\' OR Image LIKE '%/lscpu' ESCAPE '\\' OR Image LIKE '%/lsmod' ESCAPE '\\'"
  ],
  "rule_level": "informational",
  "tags": [
    "attack.discovery",
    "attack.t1082"
  ],
  "count": 2,
  "matches": [
    {
      "row_id": 150,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 1,
      "Version": 5,
      "Level": 4,
      "Task": 1,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-16T12:51:49.331051000Z",
      "EventRecordID": 797077,
      "ProcessID": "1624",
      "ThreadID": "1624",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-16 12:51:50.034",
      "ProcessGuid": "{8b8a9dc4-3466-696a-f175-e77ec55d0000}",
      "Image": "/usr/bin/uname",
      "User": "root",
      "OriginalLogfile": "Kaspersky_Endpoint_Security_Stopped_Via_CommandLine_attack218.log-NS64GTF4.json",
      "FileVersion": "-",
      "Description": "-",
      "Product": "-",
      "Company": "-",
      "OriginalFileName": "-",
      "CommandLine": "uname -svm",
      "CurrentDirectory": "/",
      "LogonGuid": "{8b8a9dc4-0000-0000-0000-000000000000}",
      "LogonId": 0,
      "TerminalSessionId": 4294967295,
      "IntegrityLevel": "no level",
      "SHA256": "ca548e23cdccdf65e6d15b9f181f94a51d817edb60e83cd7013fab0e2a18568f",
      "Hashes": "SHA256=ca548e23cdccdf65e6d15b9f181f94a51d817edb60e83cd7013fab0e2a18568f",
      "ParentProcessGuid": "{8b8a9dc4-3466-696a-1dc8-ba2a2c560000}",
      "ParentProcessId": 32486,
      "ParentImage": "/usr/bin/dash",
      "ParentCommandLine": "/bin/sh",
      "ParentUser": "root"
    },
    {
      "row_id": 152,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 5,
      "Version": 3,
      "Level": 4,
      "Task": 5,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-16T12:51:49.332419000Z",
      "EventRecordID": 797079,
      "ProcessID": "1624",
      "ThreadID": "1624",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-16 12:51:50.038",
      "ProcessGuid": "{8b8a9dc4-3466-696a-f175-e77ec55d0000}",
      "Image": "/usr/bin/uname",
      "User": "root",
      "OriginalLogfile": "Kaspersky_Endpoint_Security_Stopped_Via_CommandLine_attack218.log-NS64GTF4.json"
    }
  ]
},
{
  "title": "Execution Of Script Located In Potentially Suspicious Directory",
  "id": "30bcce26-51c5-49f2-99c8-7b59e3af36c7",
  "description": "Detects executions of scripts located in potentially suspicious locations such as \"/tmp\" via a shell such as \"bash\", \"sh\", etc.",
  "sigmafile": "",
  "sigma": [
    "SELECT * FROM logs WHERE (Image LIKE '%/bash' ESCAPE '\\' OR Image LIKE '%/csh' ESCAPE '\\' OR Image LIKE '%/dash' ESCAPE '\\' OR Image LIKE '%/fish' ESCAPE '\\' OR Image LIKE '%/ksh' ESCAPE '\\' OR Image LIKE '%/sh' ESCAPE '\\' OR Image LIKE '%/zsh' ESCAPE '\\') AND CommandLine LIKE '% -c %' ESCAPE '\\' AND CommandLine LIKE '%/tmp/%' ESCAPE '\\'"
  ],
  "rule_level": "medium",
  "tags": [
    "attack.execution"
  ],
  "count": 1,
  "matches": [
    {
      "row_id": 8,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 1,
      "Version": 5,
      "Level": 4,
      "Task": 1,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-16T12:51:49.181021000Z",
      "EventRecordID": 796935,
      "ProcessID": "1624",
      "ThreadID": "1624",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-16 12:51:49.886",
      "ProcessGuid": "{8b8a9dc4-3465-696a-1d98-150d24600000}",
      "Image": "/usr/bin/dash",
      "User": "root",
      "OriginalLogfile": "Kaspersky_Endpoint_Security_Stopped_Via_CommandLine_attack218.log-NS64GTF4.json",
      "FileVersion": "-",
      "Description": "-",
      "Product": "-",
      "Company": "-",
      "OriginalFileName": "-",
      "CommandLine": "/bin/sh -c cp /bin/systemctl /tmp/run; chmod +x /tmp/run; /tmp/run stop kesl && /tmp/run disable kesl",
      "CurrentDirectory": "/home/vincenzolog/Auto_test",
      "LogonGuid": "{8b8a9dc4-0000-0000-0000-000003000000}",
      "LogonId": 0,
      "TerminalSessionId": 3,
      "IntegrityLevel": "no level",
      "SHA256": "86d31f6fb799e91fa21bad341484564510ca287703a16e9e46c53338776f4f42",
      "Hashes": "SHA256=86d31f6fb799e91fa21bad341484564510ca287703a16e9e46c53338776f4f42",
      "ParentProcessGuid": "{8b8a9dc4-30cf-696a-dd23-700000000000}",
      "ParentProcessId": 12362,
      "ParentImage": "/usr/bin/python3.12",
      "ParentCommandLine": "python3",
      "ParentUser": "root"
    }
  ]
},
{
  "title": "Potentially Suspicious Execution From Tmp Folder",
  "id": "312b42b1-bded-4441-8b58-163a3af58775",
  "description": "Detects a potentially suspicious execution of a process located in the '/tmp/' folder",
  "sigmafile": "",
  "sigma": [
    "SELECT * FROM logs WHERE Image LIKE '/tmp/%' ESCAPE '\\' AND (NOT Image LIKE '%/usr/bin/nextcloud' ESCAPE '\\')"
  ],
  "rule_level": "medium",
  "tags": [
    "attack.defense-evasion",
    "attack.t1036"
  ],
  "count": 4,
  "matches": [
    {
      "row_id": 13,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 1,
      "Version": 5,
      "Level": 4,
      "Task": 1,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-16T12:51:49.189616000Z",
      "EventRecordID": 796940,
      "ProcessID": "1624",
      "ThreadID": "1624",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-16 12:51:49.894",
      "ProcessGuid": "{8b8a9dc4-3465-696a-7d97-567a80610000}",
      "Image": "/tmp/run",
      "User": "root",
      "OriginalLogfile": "Kaspersky_Endpoint_Security_Stopped_Via_CommandLine_attack218.log-NS64GTF4.json",
      "FileVersion": "-",
      "Description": "-",
      "Product": "-",
      "Company": "-",
      "OriginalFileName": "-",
      "CommandLine": "/tmp/run stop kesl",
      "CurrentDirectory": "/home/vincenzolog/Auto_test",
      "LogonGuid": "{8b8a9dc4-0000-0000-0000-000003000000}",
      "LogonId": 0,
      "TerminalSessionId": 3,
      "IntegrityLevel": "no level",
      "SHA256": "9dd42d9c778bb8194ba3161b06b6247a4b0a28baf6cfe27c203d861453f0334e",
      "Hashes": "SHA256=9dd42d9c778bb8194ba3161b06b6247a4b0a28baf6cfe27c203d861453f0334e",
      "ParentProcessGuid": "{8b8a9dc4-3465-696a-1d98-150d24600000}",
      "ParentProcessId": 32358,
      "ParentImage": "/usr/bin/dash",
      "ParentCommandLine": "/bin/sh",
      "ParentUser": "root"
    },
    {
      "row_id": 16,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 5,
      "Version": 3,
      "Level": 4,
      "Task": 5,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-16T12:51:49.195000000Z",
      "EventRecordID": 796943,
      "ProcessID": "1624",
      "ThreadID": "1624",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-16 12:51:49.901",
      "ProcessGuid": "{8b8a9dc4-3465-696a-7d97-567a80610000}",
      "Image": "/tmp/run",
      "User": "root",
      "OriginalLogfile": "Kaspersky_Endpoint_Security_Stopped_Via_CommandLine_attack218.log-NS64GTF4.json"
    },
    {
      "row_id": 17,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 1,
      "Version": 5,
      "Level": 4,
      "Task": 1,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-16T12:51:49.197012000Z",
      "EventRecordID": 796944,
      "ProcessID": "1624",
      "ThreadID": "1624",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-16 12:51:49.901",
      "ProcessGuid": "{8b8a9dc4-3465-696a-7df7-830247590000}",
      "Image": "/tmp/run",
      "User": "root",
      "OriginalLogfile": "Kaspersky_Endpoint_Security_Stopped_Via_CommandLine_attack218.log-NS64GTF4.json",
      "FileVersion": "-",
      "Description": "-",
      "Product": "-",
      "Company": "-",
      "OriginalFileName": "-",
      "CommandLine": "/tmp/run disable kesl",
      "CurrentDirectory": "/home/vincenzolog/Auto_test",
      "LogonGuid": "{8b8a9dc4-0000-0000-0000-000003000000}",
      "LogonId": 0,
      "TerminalSessionId": 3,
      "IntegrityLevel": "no level",
      "SHA256": "9dd42d9c778bb8194ba3161b06b6247a4b0a28baf6cfe27c203d861453f0334e",
      "Hashes": "SHA256=9dd42d9c778bb8194ba3161b06b6247a4b0a28baf6cfe27c203d861453f0334e",
      "ParentProcessGuid": "{8b8a9dc4-3465-696a-1d98-150d24600000}",
      "ParentProcessId": 32358,
      "ParentImage": "/usr/bin/dash",
      "ParentCommandLine": "/bin/sh",
      "ParentUser": "root"
    },
    {
      "row_id": 200,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 5,
      "Version": 3,
      "Level": 4,
      "Task": 5,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-16T12:51:49.622399000Z",
      "EventRecordID": 797127,
      "ProcessID": "1624",
      "ThreadID": "1624",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-16 12:51:50.329",
      "ProcessGuid": "{8b8a9dc4-3465-696a-7df7-830247590000}",
      "Image": "/tmp/run",
      "User": "root",
      "OriginalLogfile": "Kaspersky_Endpoint_Security_Stopped_Via_CommandLine_attack218.log-NS64GTF4.json"
    }
  ]
},
{
  "title": "Chmod Suspicious Directory",
  "id": "6419afd1-3742-47a5-a7e6-b50386cd15f8",
  "description": "Detects chmod targeting files in abnormal directory paths.",
  "sigmafile": "",
  "sigma": [
    "SELECT * FROM logs WHERE Image LIKE '%/chmod' ESCAPE '\\' AND (CommandLine LIKE '%/tmp/%' ESCAPE '\\' OR CommandLine LIKE '%/.Library/%' ESCAPE '\\' OR CommandLine LIKE '%/etc/%' ESCAPE '\\' OR CommandLine LIKE '%/opt/%' ESCAPE '\\')"
  ],
  "rule_level": "medium",
  "tags": [
    "attack.defense-evasion",
    "attack.t1222.002"
  ],
  "count": 1,
  "matches": [
    {
      "row_id": 11,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 1,
      "Version": 5,
      "Level": 4,
      "Task": 1,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-16T12:51:49.186495000Z",
      "EventRecordID": 796938,
      "ProcessID": "1624",
      "ThreadID": "1624",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-16 12:51:49.892",
      "ProcessGuid": "{8b8a9dc4-3465-696a-d1af-957f6f5d0000}",
      "Image": "/usr/bin/chmod",
      "User": "root",
      "OriginalLogfile": "Kaspersky_Endpoint_Security_Stopped_Via_CommandLine_attack218.log-NS64GTF4.json",
      "FileVersion": "-",
      "Description": "-",
      "Product": "-",
      "Company": "-",
      "OriginalFileName": "-",
      "CommandLine": "chmod +x /tmp/run",
      "CurrentDirectory": "/home/vincenzolog/Auto_test",
      "LogonGuid": "{8b8a9dc4-0000-0000-0000-000003000000}",
      "LogonId": 0,
      "TerminalSessionId": 3,
      "IntegrityLevel": "no level",
      "SHA256": "f162501708c719c786ddceb78c2cc3b48dc2e33683114da199223c978bd62324",
      "Hashes": "SHA256=f162501708c719c786ddceb78c2cc3b48dc2e33683114da199223c978bd62324",
      "ParentProcessGuid": "{8b8a9dc4-3465-696a-1d98-150d24600000}",
      "ParentProcessId": 32358,
      "ParentImage": "/usr/bin/dash",
      "ParentCommandLine": "/bin/sh",
      "ParentUser": "root"
    }
  ]
}]