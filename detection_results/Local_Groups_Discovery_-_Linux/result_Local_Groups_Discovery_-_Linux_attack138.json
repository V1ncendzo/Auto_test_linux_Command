[{
  "title": "Syslog Clearing or Removal Via System Utilities",
  "id": "3fcc9b35-39e4-44c0-a2ad-9e82b6902b31",
  "description": "Detects specific commands commonly used to remove or empty the syslog. Which is a technique often used by attacker as a method to hide their tracks\n",
  "sigmafile": "",
  "sigma": [
    "SELECT * FROM logs WHERE (CommandLine LIKE '%/var/log/syslog%' ESCAPE '\\' AND ((Image LIKE '%/rm' ESCAPE '\\' AND (CommandLine LIKE '% -r %' ESCAPE '\\' OR CommandLine LIKE '% -f %' ESCAPE '\\' OR CommandLine LIKE '% -rf %' ESCAPE '\\' OR CommandLine LIKE '%/var/log/syslog%' ESCAPE '\\')) OR Image LIKE '%/unlink' ESCAPE '\\' OR Image LIKE '%/mv' ESCAPE '\\' OR (Image LIKE '%/truncate' ESCAPE '\\' AND (CommandLine LIKE '%0 %' ESCAPE '\\' AND CommandLine LIKE '%/var/log/syslog%' ESCAPE '\\') AND (CommandLine LIKE '%-s %' ESCAPE '\\' OR CommandLine LIKE '%-c %' ESCAPE '\\' OR CommandLine LIKE '%--size%' ESCAPE '\\')) OR (Image LIKE '%/ln' ESCAPE '\\' AND (CommandLine LIKE '%/dev/null %' ESCAPE '\\' AND CommandLine LIKE '%/var/log/syslog%' ESCAPE '\\') AND (CommandLine LIKE '%-sf %' ESCAPE '\\' OR CommandLine LIKE '%-sfn %' ESCAPE '\\' OR CommandLine LIKE '%-sfT %' ESCAPE '\\')) OR (Image LIKE '%/cp' ESCAPE '\\' AND CommandLine LIKE '%/dev/null%' ESCAPE '\\') OR (Image LIKE '%/shred' ESCAPE '\\' AND CommandLine LIKE '%-u %' ESCAPE '\\'))) OR ((CommandLine LIKE '% > /var/log/syslog%' ESCAPE '\\' OR CommandLine LIKE '% >/var/log/syslog%' ESCAPE '\\' OR CommandLine LIKE '% >| /var/log/syslog%' ESCAPE '\\' OR CommandLine LIKE '%: > /var/log/syslog%' ESCAPE '\\' OR CommandLine LIKE '%:> /var/log/syslog%' ESCAPE '\\' OR CommandLine LIKE '%:>/var/log/syslog%' ESCAPE '\\' OR CommandLine LIKE '%>|/var/log/syslog%' ESCAPE '\\') OR (CommandLine LIKE '%journalctl --vacuum%' ESCAPE '\\' OR CommandLine LIKE '%journalctl --rotate%' ESCAPE '\\'))"
  ],
  "rule_level": "high",
  "tags": [
    "attack.defense-evasion",
    "attack.t1070.002"
  ],
  "count": 2,
  "matches": [
    {
      "row_id": 4,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 1,
      "Version": 5,
      "Level": 4,
      "Task": 1,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-13T06:41:54.860843000Z",
      "EventRecordID": 512980,
      "ProcessID": "5412",
      "ThreadID": "5412",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-12 09:35:26.250",
      "ProcessGuid": "{8b8a9dc4-c05e-6964-1db8-a2d81a580000}",
      "Image": "/usr/bin/dash",
      "User": "root",
      "OriginalLogfile": "Local_Groups_Discovery_-_Linux_attack138.log-TB16QKG5.json",
      "FileVersion": "-",
      "Description": "-",
      "Product": "-",
      "Company": "-",
      "OriginalFileName": "-",
      "CommandLine": "/bin/sh -c journalctl --vacuum-time=1s",
      "CurrentDirectory": "/home/vincenzolog/Auto_test",
      "LogonGuid": "{8b8a9dc4-0000-0000-0000-000004000000}",
      "LogonId": 0,
      "TerminalSessionId": 3,
      "IntegrityLevel": "no level",
      "SHA256": "86d31f6fb799e91fa21bad341484564510ca287703a16e9e46c53338776f4f42",
      "Hashes": "SHA256=86d31f6fb799e91fa21bad341484564510ca287703a16e9e46c53338776f4f42",
      "ParentProcessGuid": "{8b8a9dc4-be24-6964-1d23-700000000000}",
      "ParentProcessId": 154367,
      "ParentImage": "/usr/bin/python3.12",
      "ParentCommandLine": "python3",
      "ParentUser": "root"
    },
    {
      "row_id": 5,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 1,
      "Version": 5,
      "Level": 4,
      "Task": 1,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-13T06:41:54.862683000Z",
      "EventRecordID": 512981,
      "ProcessID": "5412",
      "ThreadID": "5412",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-12 09:35:26.252",
      "ProcessGuid": "{8b8a9dc4-c05e-6964-cdab-0d95a55c0000}",
      "Image": "/usr/bin/journalctl",
      "User": "root",
      "OriginalLogfile": "Local_Groups_Discovery_-_Linux_attack138.log-TB16QKG5.json",
      "FileVersion": "-",
      "Description": "-",
      "Product": "-",
      "Company": "-",
      "OriginalFileName": "-",
      "CommandLine": "journalctl --vacuum-time=1s",
      "CurrentDirectory": "/home/vincenzolog/Auto_test",
      "LogonGuid": "{8b8a9dc4-0000-0000-0000-000004000000}",
      "LogonId": 0,
      "TerminalSessionId": 3,
      "IntegrityLevel": "no level",
      "SHA256": "7bd10a9c601c3204a6c464fc517b204e469eca7f12b09f9c4826f3cc1e42bd79",
      "Hashes": "SHA256=7bd10a9c601c3204a6c464fc517b204e469eca7f12b09f9c4826f3cc1e42bd79",
      "ParentProcessGuid": "{8b8a9dc4-c05e-6964-1db8-a2d81a580000}",
      "ParentProcessId": 159906,
      "ParentImage": "/usr/bin/dash",
      "ParentCommandLine": "/bin/sh",
      "ParentUser": "root"
    }
  ]
},
{
  "title": "Local Groups Discovery - Linux",
  "id": "676381a6-15ca-4d73-a9c8-6a22e970b90d",
  "description": "Detects enumeration of local system groups. Adversaries may attempt to find local system groups and permission settings",
  "sigmafile": "",
  "sigma": [
    "SELECT * FROM logs WHERE Image LIKE '%/groups' ESCAPE '\\' OR ((Image LIKE '%/cat' ESCAPE '\\' OR Image LIKE '%/ed' ESCAPE '\\' OR Image LIKE '%/head' ESCAPE '\\' OR Image LIKE '%/less' ESCAPE '\\' OR Image LIKE '%/more' ESCAPE '\\' OR Image LIKE '%/nano' ESCAPE '\\' OR Image LIKE '%/tail' ESCAPE '\\' OR Image LIKE '%/vi' ESCAPE '\\' OR Image LIKE '%/vim' ESCAPE '\\') AND CommandLine LIKE '%/etc/group%' ESCAPE '\\')"
  ],
  "rule_level": "low",
  "tags": [
    "attack.discovery",
    "attack.t1069.001"
  ],
  "count": 1,
  "matches": [
    {
      "row_id": 34,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 1,
      "Version": 5,
      "Level": 4,
      "Task": 1,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-13T06:41:55.874608000Z",
      "EventRecordID": 513010,
      "ProcessID": "5412",
      "ThreadID": "5412",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-12 09:35:27.264",
      "ProcessGuid": "{8b8a9dc4-c05f-6964-b154-f6bf63580000}",
      "Image": "/usr/bin/cat",
      "User": "root",
      "OriginalLogfile": "Local_Groups_Discovery_-_Linux_attack138.log-TB16QKG5.json",
      "FileVersion": "-",
      "Description": "-",
      "Product": "-",
      "Company": "-",
      "OriginalFileName": "-",
      "CommandLine": "cat /etc/group",
      "CurrentDirectory": "/home/vincenzolog/Auto_test",
      "LogonGuid": "{8b8a9dc4-0000-0000-0000-000004000000}",
      "LogonId": 0,
      "TerminalSessionId": 3,
      "IntegrityLevel": "no level",
      "SHA256": "dda0961715677dff3cd560e1933379c0eca73c0b6e19fef2737492ebc1de1700",
      "Hashes": "SHA256=dda0961715677dff3cd560e1933379c0eca73c0b6e19fef2737492ebc1de1700",
      "ParentProcessGuid": "{8b8a9dc4-c05f-6964-2d23-010408610000}",
      "ParentProcessId": 159923,
      "ParentImage": "/usr/bin/bash",
      "ParentCommandLine": "bash",
      "ParentUser": "root"
    }
  ]
},
{
  "title": "Decode Base64 Encoded Text",
  "id": "e2072cab-8c9a-459b-b63c-40ae79e27031",
  "description": "Detects usage of base64 utility to decode arbitrary base64-encoded text",
  "sigmafile": "",
  "sigma": [
    "SELECT * FROM logs WHERE Image LIKE '%/base64' ESCAPE '\\' AND CommandLine LIKE '%-d%' ESCAPE '\\'"
  ],
  "rule_level": "low",
  "tags": [
    "attack.defense-evasion",
    "attack.t1027"
  ],
  "count": 1,
  "matches": [
    {
      "row_id": 31,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 1,
      "Version": 5,
      "Level": 4,
      "Task": 1,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-13T06:41:55.872074000Z",
      "EventRecordID": 513007,
      "ProcessID": "5412",
      "ThreadID": "5412",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-12 09:35:27.261",
      "ProcessGuid": "{8b8a9dc4-c05f-6964-3128-a489205f0000}",
      "Image": "/usr/bin/base64",
      "User": "root",
      "OriginalLogfile": "Local_Groups_Discovery_-_Linux_attack138.log-TB16QKG5.json",
      "FileVersion": "-",
      "Description": "-",
      "Product": "-",
      "Company": "-",
      "OriginalFileName": "-",
      "CommandLine": "base64 --decode",
      "CurrentDirectory": "/home/vincenzolog/Auto_test",
      "LogonGuid": "{8b8a9dc4-0000-0000-0000-000004000000}",
      "LogonId": 0,
      "TerminalSessionId": 3,
      "IntegrityLevel": "no level",
      "SHA256": "40e5639fa360b47ffb5f512c0644280dc6f7fdb7a3141e1df11bab4bb4253d60",
      "Hashes": "SHA256=40e5639fa360b47ffb5f512c0644280dc6f7fdb7a3141e1df11bab4bb4253d60",
      "ParentProcessGuid": "{8b8a9dc4-c05f-6964-1d38-966426590000}",
      "ParentProcessId": 159920,
      "ParentImage": "/usr/bin/dash",
      "ParentCommandLine": "/bin/sh",
      "ParentUser": "root"
    }
  ]
},
{
  "title": "Linux Base64 Encoded Pipe to Shell",
  "id": "ba592c6d-6888-43c3-b8c6-689b8fe47337",
  "description": "Detects suspicious process command line that uses base64 encoded input for execution with a shell",
  "sigmafile": "",
  "sigma": [
    "SELECT * FROM logs WHERE CommandLine LIKE '%base64 %' ESCAPE '\\' AND ((CommandLine LIKE '%| bash %' ESCAPE '\\' OR CommandLine LIKE '%| sh %' ESCAPE '\\' OR CommandLine LIKE '%|bash %' ESCAPE '\\' OR CommandLine LIKE '%|sh %' ESCAPE '\\') OR (CommandLine LIKE '% |sh' ESCAPE '\\' OR CommandLine LIKE '%| bash' ESCAPE '\\' OR CommandLine LIKE '%| sh' ESCAPE '\\' OR CommandLine LIKE '%|bash' ESCAPE '\\'))"
  ],
  "rule_level": "medium",
  "tags": [
    "attack.defense-evasion",
    "attack.t1140"
  ],
  "count": 1,
  "matches": [
    {
      "row_id": 29,
      "Provider_Name": "Linux-Sysmon",
      "Guid": "{ff032593-a8d3-4f13-b0d6-01fc615a0f97}",
      "EventID": 1,
      "Version": 5,
      "Level": 4,
      "Task": 1,
      "Opcode": 0,
      "Keywords": "0x8000000000000000",
      "SystemTime": "2026-01-13T06:41:55.870003000Z",
      "EventRecordID": 513005,
      "ProcessID": "5412",
      "ThreadID": "5412",
      "Channel": "Linux-Sysmon/Operational",
      "Computer": "vincenzolog-VMware-Virtual-Platform",
      "UserId": "0",
      "RuleName": "-",
      "UtcTime": "2026-01-12 09:35:27.259",
      "ProcessGuid": "{8b8a9dc4-c05f-6964-1d38-966426590000}",
      "Image": "/usr/bin/dash",
      "User": "root",
      "OriginalLogfile": "Local_Groups_Discovery_-_Linux_attack138.log-TB16QKG5.json",
      "FileVersion": "-",
      "Description": "-",
      "Product": "-",
      "Company": "-",
      "OriginalFileName": "-",
      "CommandLine": "/bin/sh -c echo 'Y2F0IC9ldGMvZ3JvdXA=' | base64 --decode | bash",
      "CurrentDirectory": "/home/vincenzolog/Auto_test",
      "LogonGuid": "{8b8a9dc4-0000-0000-0000-000004000000}",
      "LogonId": 0,
      "TerminalSessionId": 3,
      "IntegrityLevel": "no level",
      "SHA256": "86d31f6fb799e91fa21bad341484564510ca287703a16e9e46c53338776f4f42",
      "Hashes": "SHA256=86d31f6fb799e91fa21bad341484564510ca287703a16e9e46c53338776f4f42",
      "ParentProcessGuid": "{8b8a9dc4-be24-6964-1d23-700000000000}",
      "ParentProcessId": 154367,
      "ParentImage": "/usr/bin/python3.12",
      "ParentCommandLine": "python3",
      "ParentUser": "root"
    }
  ]
}]