title: Crontab Enumeration (Enhanced)
id: 403ed92c-b7ec-4edd-9947-5b535ee12d46
status: test
description: Detects usage of crontab to list scheduled tasks for the current user or a specified user.
references:
  - https://blogs.jpcert.or.jp/en/2023/05/gobrat.html
  - https://jstnk9.github.io/jstnk9/research/GobRAT-Malware/
  - https://www.virustotal.com/gui/file/60bcd645450e4c846238cf0e7226dc40c84c96eba99f6b2cffcd0ab4a391c8b3/detection
  - https://www.virustotal.com/gui/file/3e44c807a25a56f4068b5b8186eee5002eed6f26d665a8b791c472ad154585d1/detection
author: Joseliyo Sanchez, @Joseliyo_Jstnk (enhanced by ChatGPT)
date: 2023-06-02
modified: 2026-01-18
tags:
  - attack.discovery
  - attack.t1007
logsource:
  product: linux
  category: process_creation

detection:
  # 1) More robust Image match:
  #    - handles "/usr/bin/crontab", "/bin/crontab", and also plain "crontab"
  selection_image:
    Image|endswith:
      - '/crontab'
      - 'crontab'

  # 2) Detect listing:
  #    - covers "crontab -l"
  #    - covers "crontab -u <user> -l"
  #    - covers reordered flags where -l still appears
  selection_list_current:
    CommandLine|contains:
      - ' -l'
  selection_list_other_user:
    CommandLine|contains|all:
      - ' -u'
      - ' -l'

  # 3) Reduce obvious noise / false positives (optional but helpful):
  #    - ignore help/version output often used by admins or scripts
  filter_noise:
    CommandLine|contains:
      - ' --help'
      - ' -h'
      - ' --version'
      - ' -V'

  condition: selection_image and (selection_list_current or selection_list_other_user) and not filter_noise

falsepositives:
  - Legitimate use of crontab by administrators or users
  - System management scripts that enumerate cron entries
level: low
