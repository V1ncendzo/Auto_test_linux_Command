filter: 'process.command_line: "*/etc/opt/microsoft/scx/conf/tmpdir/scx*"'
pre_detector:
  case_condition: directly
  id: 6eea1bf6-f8d2-488a-a742-e6ef6c1b67db
  mitre:
  - attack.privilege_escalation
  - attack.initial_access
  - attack.execution
  - attack.t1068
  - attack.t1190
  - attack.t1203
  severity: high
  title: OMIGOD SCX RunAsProvider ExecuteScript
sigma_fields: true
description: 'Rule to detect the use of the SCX RunAsProvider ExecuteScript to execute
  any UNIX/Linux script using the /bin/sh shell.

  Script being executed gets created as a temp file in /tmp folder with a scx* prefix.

  Then it is invoked from the following directory /etc/opt/microsoft/scx/conf/tmpdir/.

  The file in that directory has the same prefix scx*. SCXcore, started as the Microsoft
  Operations Manager UNIX/Linux Agent, is now used in a host of products including

  Microsoft Operations Manager, Microsoft Azure, and Microsoft Operations Management
  Suite.

  '
